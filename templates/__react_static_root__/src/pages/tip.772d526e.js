(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{124:function(e,t,n){"use strict";n.r(t);var a=n(4),c=n.n(a),r=n(2),i=n.n(r),s=n(28),o=n.n(s),u=n(21),l=n.n(u),p=n(88),d=n(92),f=n(43),m=n(120),b=n.n(m),h=n(62),v=n(96),w=n(238),g=n(58),E=n(55),x=n(91),j=n(45),O=n(227),k=n.n(O),y=(n(215),new k.a),N=function(e){var t=Object(f.b)(),n=t.account,r=t.active,s=t.chainId,u=t.library,m=Object(E.b)(),h=m.signer,w=(m.feeBalance,m.donutBalance,m.token),g=(m.tipping,Object(a.useState)(!1)),O=l()(g,2),k=O[0],N=O[1],T=Object(a.useState)(""),D=l()(T,2),I=D[0],F=D[1],L=Object(a.useState)(e.contentId),P=l()(L,2),R=P[0],_=P[1],A=Object(a.useState)(e.recipient),B=l()(A,2),J=B[0],q=B[1],K=Object(a.useState)(e.address),W=l()(K,2),z=W[0],G=W[1],H=Object(a.useState)(),M=l()(H,2),Q=M[0],V=M[1],X=Object(a.useState)("1,000"),Y=l()(X,2),Z=Y[0],$=Y[1],ee=Object(a.useState)(!1),te=l()(ee,2),ne=te[0],ae=te[1],ce=Object(a.useState)(""),re=l()(ce,2),ie=re[0],se=re[1];Object(a.useEffect)((function(){if(!I)return _(""),void q("");var e="",t=0;try{var n=new URL(I).pathname.split("/").filter((function(e){return!!e}));6===n.length?(e=n[5],t=1):5===n.length?(e=n[3],t=3):2===n.length&&["u","user"].includes(n[0])?q(n[1]):oe(I)}catch(a){I.includes("/")?oe(I):Object(x.d)(I).then((function(e){e?q(I):oe(I)}))}[1,3].includes(t)&&_("t".concat(t,"_").concat(e))}),[I]);var oe=function(e){alert("".concat(e," could not be identified as a Reddit post, comment, or user.")),F("")};function ue(){return le.apply(this,arguments)}function le(){return(le=o()(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.allowance(n,j.b[s].tipping);case 2:t=e.sent,ae(t.gte(Object(v.b)(Z.replace(/,/g,""))));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){function e(){return(e=o()(i.a.mark((function e(){var t,n,a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.b)("https://www.reddit.com/api/info.json?id=".concat(R));case 2:t=e.sent,n=t.data.children[0],a=n.kind,c=n.data,q(c.author),"t3"===a?se(c.title):"t1"===a&&se(c.body);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}R?function(){e.apply(this,arguments)}():se("")}),[R]),Object(a.useEffect)((function(){if(!J)return G(""),void V("");function e(){return(e=o()(i.a.mark((function e(){var t,n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.b)("https://old.reddit.com/user/".concat(J,"/about.json"));case 2:if(t=e.sent,!t.error){e.next=8;break}return F(""),q(""),e.abrupt("return");case 8:return(n=Object(x.c)({username:J}))&&!z&&G(n.address),e.next=12,y.getPublicAddress({verifier:"reddit",verifierId:J});case 12:a=e.sent,V(a);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[J]),Object(a.useEffect)((function(){w?ue():ae(!1)}),[w,Z]);var pe,de,fe,me,be=k||!Z,he=b()("complete cute-pink-btn",{disabled:be}),ve=Object(a.useState)(!0),we=l()(ve,2);we[0],we[1];return z?(pe=z,de=c.a.createElement("span",{style:{cursor:"default",marginLeft:".25em"},title:"Using donut registered address for ".concat(J," (").concat(pe,")")},"üç©")):Q?(pe=Q,de=c.a.createElement("img",{className:"torus-logo",src:"/torus_logo.png",alt:"Torus Logo",title:"Using Tor.us address for ".concat(J," (").concat(pe,")")})):de=c.a.createElement("span",{className:"wait"}),fe=r?100===s?ne?c.a.createElement("div",{className:he,onClick:function(){return function(e,t,n,a,c,r,i){return U.apply(this,arguments)}(h,s,"DONUT",pe,Z,R,N)}},"Send Tip"):c.a.createElement("div",{className:he,onClick:function(){return function(e,t,n){return S.apply(this,arguments)}(w.connect(h),j.b[s].tipping,N).then(ue)}},"Approve"):c.a.createElement("div",{className:he,onClick:function(){return function(e,t){return C.apply(this,arguments)}(u,N)}},"Use xDai"):c.a.createElement("div",{className:"complete cute-pink-btn disabled"},"Connect Wallet First"),J&&(me=c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{style:{textDecoration:"none"},href:"https://www.reddit.com/u/".concat(J)},"u/",J),c.a.createElement(p.a,{className:"cancel",icon:d.a,onClick:function(){F("")}}))),c.a.createElement("div",{className:"tipping-interface box"},c.a.createElement("div",{className:"tip-token"},"üç©"),c.a.createElement("div",{className:"cute-header tip-info"},"Tip ",me),c.a.createElement("div",{className:"tip-token-info"},"EthTrader DONUTs"),ie||J?c.a.createElement("div",{className:"reddit-preview"},c.a.createElement("h3",{className:"author"},J," ",de),ie&&c.a.createElement("p",{className:"body"},ie)):c.a.createElement("div",{className:"cute-input target-container"},c.a.createElement("input",{placeholder:"Paste recipient or content url",value:I,onChange:function(e){return F(e.target.value)},onKeyPress:x.e})),c.a.createElement("div",{className:"cute-input quantity-container"},c.a.createElement("input",{value:Z,onChange:function(e){return function(e){$(Object(x.a)(e.replace(/,/g,"")))}(e.target.value)}}),c.a.createElement("div",{className:"token"},"DONUT")),fe)};function S(){return(S=o()(i.a.mark((function e(t,n,a){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.prev=1,e.next=4,t.approve(n,g.a);case 4:return c=e.sent,e.next=7,c.wait();case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:a(!1);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function U(){return(U=o()(i.a.mark((function e(t,n,a,c,r,s,o){var u,l,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),u=j.b[n][a],l=new h.a(j.b[n].tipping,j.a.Tipping,t),e.prev=3,e.next=6,l.tip(c,Object(v.b)(r.toString()),u,Object(w.a)(s));case 6:return p=e.sent,e.next=9,p.wait();case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(3);case 13:o(!1);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}function C(){return(C=o()(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),e.prev=1,e.next=4,t.jsonRpcFetchFunc("wallet_addEthereumChain",[{chainId:"0x64",chainName:"xDai",nativeCurrency:{name:"xDai",symbol:"xDai",decimals:18},rpcUrls:["https://rpc.xdaichain.com/"],blockExplorerUrls:["https://blockscout.com/xdai/mainnet"]}]);case 4:e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:n(!1);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}t.default=function(){var e,t=(e="","undefined"!=typeof window&&(e=window.location.search),new URLSearchParams(e));return c.a.createElement(N,{recipient:t.get("recipient"),address:t.get("address"),contentId:t.get("contentId")})}}}]);