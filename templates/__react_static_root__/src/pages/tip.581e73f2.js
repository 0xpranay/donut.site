(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{125:function(e,t,n){"use strict";n.r(t);var a=n(4),c=n.n(a),r=n(222);t.default=function(){var e,t=(e="","undefined"!=typeof window&&(e=window.location.search),new URLSearchParams(e));return c.a.createElement(r.a,{recipient:t.get("recipient"),address:t.get("address"),contentId:t.get("contentId")})}},222:function(e,t,n){"use strict";var a,c=n(2),r=n.n(c),s=n(29),i=n.n(s),o=n(21),u=n.n(o),l=n(4),p=n.n(l),d=n(68),f=n(70),m=n(43),h=n(116),b=n.n(h),v=n(62),g=n(71),w=n(242),E=n(58),O=n(52),j=n(69),k=n(44),x=n(225),N=n.n(x),y=(n(216),new N.a);function T(){return(T=i()(r.a.mark((function e(t,n,a){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!0),e.prev=1,e.next=4,t.approve(n,E.a);case 4:return c=e.sent,e.next=7,c.wait();case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),e.t0;case 12:a(!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function C(){return(C=i()(r.a.mark((function e(t,n,a,c,s,i,o){var u,l,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=s.replace(/,/g,""),console.log(a,c,s,i),o(!0),u=k.b[n][a],l=new v.a(k.b[n].tipping,k.a.Tipping,t),e.prev=5,e.next=8,l.tip(c,Object(g.b)(s),u,Object(w.a)(i));case 8:return p=e.sent,e.next=11,p.wait();case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),e.t0;case 16:o(!1);case 17:case"end":return e.stop()}}),e,null,[[5,13]])})))).apply(this,arguments)}function S(){return(S=i()(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),e.prev=1,e.next=4,t.jsonRpcFetchFunc("wallet_addEthereumChain",[{chainId:"0x64",chainName:"xDai",nativeCurrency:{name:"xDai",symbol:"xDai",decimals:18},rpcUrls:["https://rpc.xdaichain.com/"],blockExplorerUrls:["https://blockscout.com/xdai/mainnet"]}]);case 4:e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:n(!1);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}t.a=function(e){var t=Object(m.b)(),n=t.account,c=t.active,s=t.chainId,o=t.library,h=Object(O.b)(),v=h.signer,w=(h.feeBalance,h.donutBalance,h.token),E=(h.tipping,Object(l.useState)(!1)),x=u()(E,2),N=x[0],U=x[1],D=Object(l.useState)(""),I=u()(D,2),P=I[0],R=I[1],F=Object(l.useState)(e.contentId),L=u()(F,2),_=L[0],A=L[1],B=Object(l.useState)(e.recipient||""),J=u()(B,2),q=J[0],K=J[1],W=Object(l.useState)(e.address),z=u()(W,2),G=z[0],H=z[1],M=Object(l.useState)(),Q=u()(M,2),V=Q[0],X=Q[1],Y=Object(l.useState)("1,000"),Z=u()(Y,2),$=Z[0],ee=Z[1],te=Object(l.useState)(!1),ne=u()(te,2),ae=ne[0],ce=ne[1],re=Object(l.useState)(""),se=u()(re,2),ie=se[0],oe=se[1],ue=Object(l.useRef)(null),le=Object(l.useState)(!0),pe=u()(le,2),de=pe[0],fe=pe[1];function me(){R(""),A(""),oe(""),K(""),ue&&ue.current&&ue.current.focus()}Object(l.useEffect)((function(){q&&R(e.recipient)}),[]),Object(l.useEffect)((function(){if(P){var e="",t=0;try{var n=new URL(P).pathname.split("/").filter((function(e){return!!e}));6===n.length?(e=n[5],t=1):5===n.length?(e=n[3],t=3):2===n.length&&["u","user"].includes(n[0])?K(n[1]):he(P)}catch(c){P.includes("/")?de||he(P):(clearTimeout(a),a=setTimeout((function(){return Object(j.d)(P).then((function(e){e?K(P):de||he(P)}))}),250))}[1,3].includes(t)&&A("t".concat(t,"_").concat(e))}}),[P]);var he=function(e){alert("".concat(e," could not be identified as a Reddit post, comment, or user.")),R("")};function be(){return ve.apply(this,arguments)}function ve(){return(ve=i()(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("checking approval"),e.next=3,w.allowance(n,k.b[s].tipping);case 3:t=e.sent,console.log("allowance",t),ce(t.gte(Object(g.b)($.replace(/,/g,""))));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(l.useEffect)((function(){function e(){return(e=i()(r.a.mark((function e(){var t,n,a,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.b)("https://www.reddit.com/api/info.json?id=".concat(_));case 2:t=e.sent,n=t.data.children[0],a=n.kind,c=n.data,K(c.author),"t3"===a?oe(c.title):"t1"===a&&oe(c.body);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}_?function(){e.apply(this,arguments)}():oe("")}),[_]),Object(l.useEffect)((function(){if(!q)return H(""),void X("");function e(){return(e=i()(r.a.mark((function e(){var t,n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(j.b)("https://old.reddit.com/user/".concat(q,"/about.json"));case 2:if(t=e.sent,!t.error){e.next=8;break}return R(""),K(""),e.abrupt("return");case 8:return e.next=10,Object(j.c)({username:q});case 10:return(n=e.sent)&&!G&&H(n.address),e.next=14,y.getPublicAddress({verifier:"reddit",verifierId:q});case 14:a=e.sent,X(a);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}fe(!_),function(){e.apply(this,arguments)}()}),[q]),Object(l.useEffect)((function(){w?be():ce(!1)}),[w,$]);var ge,we,Ee=Object(l.useState)(!0),Oe=u()(Ee,2);Oe[0],Oe[1];G?(ge=G,we=p.a.createElement("span",{className:"address-logo donut",style:{marginLeft:".25em"},title:"Using donut registered address for ".concat(q," (").concat(ge,")")},"üç©")):V?(ge=V,we=p.a.createElement("img",{className:"address-logo torus",src:"/torus_logo.png",alt:"Torus Logo",title:"Using Tor.us address for ".concat(q," (").concat(ge,")")})):q&&(we=p.a.createElement("span",{className:"address-logo wait"}));var je,ke,xe,Ne=N||!$||!ge,ye=b()("complete cute-pink-btn",{disabled:Ne});return je=c?100===s?ae?p.a.createElement("div",{className:ye,onClick:function(){return function(e,t,n,a,c,r,s){return C.apply(this,arguments)}(v,s,"DONUT",ge,$,_,U)}},"Send Tip"):p.a.createElement("div",{className:ye,onClick:function(){return function(e,t,n){return T.apply(this,arguments)}(w.connect(v),k.b[s].tipping,U).then(be)}},"Approve"):p.a.createElement("div",{className:ye,onClick:function(){return function(e,t){return S.apply(this,arguments)}(o,U)}},"Use xDai"):p.a.createElement("div",{className:"complete cute-pink-btn disabled"},"Connect Wallet First"),q&&(ke=p.a.createElement(p.a.Fragment,null,p.a.createElement("a",{style:{textDecoration:"none"},target:"blank",href:"https://www.reddit.com/u/".concat(q)},"/u/",q),p.a.createElement(d.a,{className:"cancel",icon:f.a,onClick:me}))),xe=de?p.a.createElement("div",{className:"cute-input target-container"},p.a.createElement("span",{className:"user-prefix",onClick:function(){return ue.current.focus()}},"/u/"),p.a.createElement("input",{ref:ue,value:q,onChange:function(e){var t=e.target.value;clearTimeout(a),a=setTimeout((function(){return Object(j.d)(t).then((function(e){return e&&K(t)}))}),250)},placeholder:"vitalik"}),we):p.a.createElement("div",{className:"cute-input target-container"},p.a.createElement("input",{ref:ue,value:P,onChange:function(e){return R(e.target.value)},onKeyPress:j.e,placeholder:"Paste a reddit post here"})),p.a.createElement("div",{className:"tipping-interface box"},p.a.createElement("div",{className:"tip-token"},"üç©"),p.a.createElement("div",{className:"cute-header tip-info"},ke?p.a.createElement("span",null,"Tipping ",ke):"Choose a ".concat(de?"User":"Post"," to Tip")),p.a.createElement("div",{className:"tip-token-info"},ke?"EthTrader DONUTs":p.a.createElement("span",null,"Or ",p.a.createElement("a",{onClick:function(){return me()||fe(!de)}},"click here")," to tip a ",de?"post":"user")),de||!ie&&!q?xe:p.a.createElement("div",{className:"reddit-preview"},p.a.createElement("h3",{className:"author"},q," ",we),ie&&p.a.createElement("p",{className:"body"},ie)),p.a.createElement("div",{className:"cute-input quantity-container"},p.a.createElement("input",{value:$,onChange:function(e){return function(e){ee(Object(j.a)(e.replace(/,/g,"")))}(e.target.value)}}),p.a.createElement("div",{className:"token"},"DONUT")),je)}}}]);